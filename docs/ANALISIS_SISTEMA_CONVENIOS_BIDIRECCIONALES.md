# An√°lisis y Recomendaciones: Sistema de Convenios Bidireccionales para Programas de Fidelizaci√≥n

**Fecha de an√°lisis:** Octubre 2025
**Proyecto:** WP Cupon WhatsApp - Sistema de Beneficios Institucionales
**Enfoque:** An√°lisis de mejores pr√°cticas y recomendaciones implementables

---

## √çndice

1. [Resumen Ejecutivo](#resumen-ejecutivo)
2. [An√°lisis del Sistema Actual](#an√°lisis-del-sistema-actual)
3. [Benchmarking de la Industria](#benchmarking-de-la-industria)
4. [Flujo Bidireccional Recomendado](#flujo-bidireccional-recomendado)
5. [Diagrama de Estados del Convenio](#diagrama-de-estados-del-convenio)
6. [Campos y Metadatos Necesarios](#campos-y-metadatos-necesarios)
7. [Estad√≠sticas e Indicadores Clave (KPIs)](#estad√≠sticas-e-indicadores-clave-kpis)
8. [Mejoras de Experiencia de Usuario (UX)](#mejoras-de-experiencia-de-usuario-ux)
9. [Plan de Implementaci√≥n](#plan-de-implementaci√≥n)
10. [Referencias de la Industria](#referencias-de-la-industria)

---

## 1. Resumen Ejecutivo

### Estado Actual
El sistema actual implementa un flujo **unidireccional** donde:
- Los COMERCIOS proponen convenios a INSTITUCIONES
- Las INSTITUCIONES aprueban/rechazan v√≠a email con token seguro
- Estados b√°sicos: `pending`, `active`, `rejected`, `expired`
- Sin capacidad de negociaci√≥n o contra-propuestas

### Hallazgos Clave de la Investigaci√≥n

#### Mejores Pr√°cticas de Marketplaces B2B (2025)
- **80% de interacciones B2B** ocurren en canales digitales (Gartner, 2025)
- Plataformas como **Pluxee** (antes Sodexo) invierten 10% de ingresos en tecnolog√≠a
- Marketplaces bidireccionales generan **$350B+ en ventas** (2024)
- Liquidez del marketplace es **el KPI m√°s cr√≠tico** (transacciones completadas)

#### Caracter√≠sticas Esenciales de Sistemas Exitosos
1. **Propuestas bidireccionales** (ambas partes pueden iniciar)
2. **Negociaci√≥n estructurada** con counter-offers
3. **Aprobaciones multi-nivel** para instituciones grandes
4. **Automatizaci√≥n de workflows** para reducir fricci√≥n
5. **M√©tricas en tiempo real** para ambas partes

---

## 2. An√°lisis del Sistema Actual

### 2.1 Arquitectura de Datos Existente

```
Custom Post Types:
‚îú‚îÄ‚îÄ wpcw_institution (Instituciones)
‚îú‚îÄ‚îÄ wpcw_business (Comercios)
‚îú‚îÄ‚îÄ wpcw_convenio (Convenios)
‚îî‚îÄ‚îÄ shop_coupon (Cupones de WooCommerce)

Tabla Custom:
‚îî‚îÄ‚îÄ wp_wpcw_canjes (Registro de canjes)

Relaciones:
- Convenio ‚Üí 1 Proveedor (Comercio)
- Convenio ‚Üí 1 Receptor (Instituci√≥n)
- Cup√≥n ‚Üí 1 Convenio (_wpcw_associated_convenio_id)
- Canje ‚Üí 1 Convenio + 1 Cup√≥n + 1 Usuario + 1 Comercio
```

### 2.2 Metadatos del Convenio Actual

| Campo | Uso Actual | Necesidad |
|-------|-----------|-----------|
| `_convenio_provider_id` | ID del comercio proveedor | **Esencial** |
| `_convenio_recipient_id` | ID de la instituci√≥n receptora | **Esencial** |
| `_convenio_status` | Estado: pending/active/rejected/expired | **Expandir** |
| `_convenio_terms` | T√©rminos en texto libre | **Mantener** |
| `_convenio_discount_percentage` | Porcentaje de descuento | Opcional |
| `_convenio_max_uses_per_beneficiary` | L√≠mite por beneficiario | Opcional |
| `_convenio_start_date` | Fecha de inicio | Opcional |
| `_convenio_end_date` | Fecha de fin | Opcional |
| `_convenio_originator_id` | Usuario que propuso | **Esencial** |
| `_convenio_response_token` | Token de seguridad para respuesta | **Mantener** |
| `_convenio_approved_by` | Usuario que aprob√≥ | **Esencial** |
| `_convenio_approved_at` | Timestamp de aprobaci√≥n | **Esencial** |

### 2.3 Flujo Actual Identificado

```
1. COMERCIO crea propuesta
   ‚îî‚îÄ> convenio (status: pending, post_status: pending)

2. Email enviado a INSTITUCI√ìN con link tokenizado
   ‚îî‚îÄ> /responder-convenio/?convenio_id=X&token=Y

3. INSTITUCI√ìN revisa en p√°gina p√∫blica
   ‚îî‚îÄ> Opciones: Aceptar | Rechazar

4. Al aceptar:
   ‚îú‚îÄ> convenio_status: 'active'
   ‚îú‚îÄ> post_status: 'publish'
   ‚îú‚îÄ> Token invalidado
   ‚îî‚îÄ> Comercio puede crear cupones

5. Al rechazar:
   ‚îú‚îÄ> convenio_status: 'rejected'
   ‚îú‚îÄ> post_status: 'trash'
   ‚îî‚îÄ> Proceso terminado
```

### 2.4 Limitaciones Identificadas

| Limitaci√≥n | Impacto | Prioridad de Soluci√≥n |
|------------|---------|----------------------|
| **No hay propuestas desde Instituciones** | Instituciones pasivas, menos compromiso | üî¥ ALTA |
| **Sin capacidad de contra-oferta** | Todo-o-nada, menor flexibilidad | üî¥ ALTA |
| **Aprobaci√≥n de un solo paso** | No funciona para instituciones grandes | üü° MEDIA |
| **Sin historial de negociaci√≥n** | Dif√≠cil auditar o aprender | üü° MEDIA |
| **No hay m√©tricas de desempe√±o** | Imposible optimizar | üî¥ ALTA |
| **Sin borradores compartidos** | No hay colaboraci√≥n pre-aprobaci√≥n | üü¢ BAJA |
| **Fechas opcionales** | Convenios sin vigencia clara | üü° MEDIA |

---

## 3. Benchmarking de la Industria

### 3.1 Pluxee (Sodexo Benefits) - L√≠der Global

**Modelo de Negocio:**
- Marketplace de beneficios corporativos
- 250+ productos en 31 pa√≠ses
- Plataforma m√≥vil-first con cashback instant√°neo

**Caracter√≠sticas Relevantes:**
- **Admin-light experience:** M√≠nima fricci√≥n administrativa para HR
- **Real-time reporting:** Dashboards con datos en vivo
- **Aprobaci√≥n centralizada:** Un dashboard para todos los beneficios
- **Integraci√≥n con n√≥mina:** Automatizaci√≥n de asignaci√≥n de beneficios

**Aplicable a nuestro proyecto:**
- Simplificar el proceso de aprobaci√≥n institucional
- Dashboard √∫nico con visibilidad completa
- Reportes autom√°ticos de uso

### 3.2 Marketplaces B2B de Dos Lados

**KPIs Cr√≠ticos Identificados:**

1. **Liquidity (Liquidez)**
   - Porcentaje de propuestas que resultan en convenios activos
   - Tiempo promedio desde propuesta hasta activaci√≥n
   - Ratio de comercios activos vs registrados

2. **Take Rate**
   - No aplicable directamente (no cobramos comisi√≥n)
   - Equivalente: % de convenios que generan canjes reales

3. **LTV/CAC Ratio**
   - Lifetime Value del convenio vs costo de adquisici√≥n
   - Meta: >3X en valor de canjes vs esfuerzo de onboarding

4. **Churn Rate**
   - % de convenios que expiran sin renovaci√≥n
   - % de instituciones/comercios que se desactivan

5. **Match Rate**
   - √âxito en conectar instituciones con comercios relevantes
   - Velocidad de match: tiempo hasta primera propuesta

### 3.3 Contract Negotiation Lifecycle (Harvard PON)

**Fases de Negociaci√≥n Documentadas:**

1. **Opening Phase (Apertura)**
   - Una parte presenta demanda/oferta inicial
   - Usualmente rechazada para abrir negociaci√≥n

2. **Testing Phase (Prueba)**
   - Ambas partes justifican posiciones
   - Probing para encontrar puntos de acuerdo

3. **Agreeing Phase (Acuerdo)**
   - T√©rminos finales acordados
   - Cierre formal

**Best Practices de Counter-Offers:**
- Skilled negotiators EVITAN contra-propuestas tempranas
- Counter-offers efectivos al FINAL del proceso
- Dos tipos de rationale: constraint (limitaciones) y disparagement (cr√≠ticas)

**Aplicable a nuestro proyecto:**
- Permitir 1-2 rondas de counter-offer como m√°ximo
- Counter-offer debe incluir justificaci√≥n obligatoria
- Timeout en negociaciones (ej: 7 d√≠as sin respuesta = expirada)

---

## 4. Flujo Bidireccional Recomendado

### 4.1 Iniciadores de Propuesta

| Iniciador | Escenario | Flujo |
|-----------|-----------|-------|
| **Comercio** | Quiere acceder a miembros de instituci√≥n espec√≠fica | Propuesta directa con t√©rminos |
| **Instituci√≥n** | Busca beneficios para sus miembros en categor√≠a | Solicitud abierta o propuesta dirigida |
| **Administrador** | Match manual entre comercio e instituci√≥n | Convenio pre-aprobado bilateral |

### 4.2 Informaci√≥n Intercambiada en la Negociaci√≥n

#### Propuesta Inicial (Cualquier Parte)
```yaml
Datos Obligatorios:
  - Proveedor (Comercio ID)
  - Receptor (Instituci√≥n ID)
  - T√©rminos del beneficio (texto)
  - Tipo de descuento (porcentaje/fijo/otro)
  - Valor del descuento
  - Vigencia (fecha inicio/fin)

Datos Opcionales:
  - Usos m√°ximos por beneficiario
  - Categor√≠as de producto aplicables
  - Restricciones geogr√°ficas
  - Horarios v√°lidos
  - Condiciones especiales
```

#### Counter-Offer
```yaml
Datos Modificables:
  - Valor del descuento (puede negociarse)
  - Vigencia (fechas)
  - Usos m√°ximos
  - T√©rminos adicionales

Datos Obligatorios:
  - Justificaci√≥n del cambio (textarea)
  - Cambios propuestos (diff autom√°tico)

Datos No Modificables:
  - Proveedor
  - Receptor
  - Tipo de beneficio base
```

### 4.3 Roles Involucrados y Permisos

| Rol | Capacidad | Acciones Permitidas |
|-----|-----------|---------------------|
| **Business Owner** | `manage_business_profile` | Proponer convenio, aceptar/rechazar propuestas recibidas, hacer counter-offer |
| **Institution Manager** | `manage_institution` | Proponer convenio, aceptar/rechazar propuestas recibidas, hacer counter-offer |
| **Benefits Supervisor** | `approve_institution_benefits` | Solo aprobar propuestas ya negociadas (segundo nivel) |
| **Administrator** | `manage_woocommerce` | Crear convenios pre-aprobados, forzar estados, auditor√≠a |

---

## 5. Diagrama de Estados del Convenio

### 5.1 Estados Expandidos Recomendados

```
Estados Propuestos (12 estados):

FASE 1: NEGOCIACI√ìN
‚îú‚îÄ draft              (Borrador en creaci√≥n)
‚îú‚îÄ pending_review     (Enviado, esperando primera revisi√≥n)
‚îú‚îÄ under_negotiation  (En negociaci√≥n activa)
‚îú‚îÄ counter_offered    (Contra-propuesta enviada)
‚îî‚îÄ awaiting_approval  (Negociaci√≥n cerrada, esperando aprobaci√≥n final)

FASE 2: APROBACI√ìN
‚îú‚îÄ pending_supervisor (Esperando aprobaci√≥n de supervisor institucional)
‚îî‚îÄ approved           (Aprobado, pendiente de activaci√≥n)

FASE 3: ACTIVO
‚îú‚îÄ active             (Convenio activo y operativo)
‚îú‚îÄ paused             (Pausado temporalmente)
‚îî‚îÄ near_expiry        (Pr√≥ximo a vencer, requiere renovaci√≥n)

FASE 4: TERMINAL
‚îú‚îÄ rejected           (Rechazado definitivamente)
‚îú‚îÄ expired            (Expir√≥ por fecha o inactividad)
‚îî‚îÄ cancelled          (Cancelado por alguna de las partes)
```

### 5.2 Diagrama de Transiciones

```mermaid
stateDiagram-v2
    [*] --> draft: Usuario inicia propuesta

    draft --> pending_review: Enviar propuesta
    draft --> [*]: Descartar borrador

    pending_review --> under_negotiation: Solicitar cambios
    pending_review --> awaiting_approval: Aceptar t√©rminos
    pending_review --> rejected: Rechazar

    under_negotiation --> counter_offered: Enviar counter-offer
    under_negotiation --> rejected: Rechazar definitivamente

    counter_offered --> under_negotiation: Responder a counter-offer
    counter_offered --> awaiting_approval: Aceptar counter-offer
    counter_offered --> expired: Timeout (7 d√≠as sin respuesta)

    awaiting_approval --> pending_supervisor: Requiere 2da aprobaci√≥n
    awaiting_approval --> approved: Aprobar (instituci√≥n peque√±a)
    awaiting_approval --> rejected: Rechazar en √∫ltima instancia

    pending_supervisor --> approved: Supervisor aprueba
    pending_supervisor --> rejected: Supervisor rechaza

    approved --> active: Activar convenio

    active --> paused: Pausar temporalmente
    active --> near_expiry: 30 d√≠as antes de expirar
    active --> cancelled: Cancelar por cualquier parte
    active --> expired: Llega a fecha fin

    paused --> active: Reactivar
    paused --> cancelled: Cancelar definitivamente

    near_expiry --> active: Renovar (actualiza fecha fin)
    near_expiry --> expired: No renovado a tiempo

    rejected --> [*]
    expired --> [*]
    cancelled --> [*]
```

### 5.3 Tabla de Transiciones V√°lidas

| Estado Actual | Estados Siguientes V√°lidos | Qui√©n Puede Transicionar |
|---------------|---------------------------|--------------------------|
| `draft` | `pending_review`, descarte | Originator |
| `pending_review` | `under_negotiation`, `awaiting_approval`, `rejected` | Receptor |
| `under_negotiation` | `counter_offered`, `rejected` | Cualquiera de las partes |
| `counter_offered` | `under_negotiation`, `awaiting_approval`, `expired` | Receptor del counter-offer |
| `awaiting_approval` | `pending_supervisor`, `approved`, `rejected` | Institution Manager |
| `pending_supervisor` | `approved`, `rejected` | Benefits Supervisor |
| `approved` | `active` | Sistema autom√°tico o Admin |
| `active` | `paused`, `near_expiry`, `cancelled`, `expired` | Business/Institution, Sistema |
| `paused` | `active`, `cancelled` | Quien paus√≥ |
| `near_expiry` | `active` (renovar), `expired` | Business/Institution, Sistema |
| Terminal: `rejected`, `expired`, `cancelled` | Sin transiciones | N/A |

---

## 6. Campos y Metadatos Necesarios

### 6.1 Nuevos Metadatos a Agregar

#### Negociaci√≥n y Versionado
```php
// Historial de negociaci√≥n
_convenio_negotiation_history: array serializado
  [
    {
      'version': 1,
      'user_id': 123,
      'user_role': 'business_owner',
      'action': 'proposed',
      'timestamp': '2025-10-13 10:30:00',
      'changes': [],
      'comment': 'Propuesta inicial'
    },
    {
      'version': 2,
      'user_id': 456,
      'user_role': 'institution_manager',
      'action': 'counter_offered',
      'timestamp': '2025-10-14 15:20:00',
      'changes': [
        'discount_percentage' => ['old' => 15, 'new' => 20],
        'max_uses_per_beneficiary' => ['old' => 0, 'new' => 3]
      ],
      'comment': 'Solicitamos incrementar descuento'
    }
  ]

// Versi√≥n actual de t√©rminos
_convenio_version_current: int (1, 2, 3...)

// Justificaci√≥n del √∫ltimo cambio
_convenio_last_change_reason: string

// Estado de aprobaci√≥n multi-nivel
_convenio_approval_level: int (1 o 2)
_convenio_requires_supervisor: bool (true/false)
_convenio_supervisor_id: int (user_id del Benefits Supervisor)
_convenio_supervisor_approved_at: datetime
```

#### M√©tricas y Tracking
```php
// Rendimiento del convenio
_convenio_total_coupons_created: int
_convenio_total_redemptions: int
_convenio_total_beneficiaries_unique: int
_convenio_last_redemption_date: date

// Alertas
_convenio_days_until_expiry: int (calculado)
_convenio_renewal_reminder_sent: bool
_convenio_last_activity_date: date

// Participaci√≥n
_convenio_initiator_type: string ('business' | 'institution' | 'admin')
_convenio_negotiation_rounds: int (contador de contra-ofertas)
```

#### Configuraci√≥n Avanzada
```php
// Restricciones geogr√°ficas
_convenio_valid_locations: array (IDs de sucursales o ciudades)

// Restricciones temporales
_convenio_valid_days_of_week: array (['monday', 'tuesday'...])
_convenio_valid_hours: string ('09:00-18:00')

// Categor√≠as de producto (si usa WooCommerce)
_convenio_valid_product_categories: array (term_ids)
_convenio_excluded_products: array (product_ids)

// Comunicaci√≥n
_convenio_primary_contact_business: string (email)
_convenio_primary_contact_institution: string (email)
_convenio_notification_preferences: array
```

### 6.2 Cambios en Post Meta Existentes

| Meta Key Actual | Acci√≥n | Nuevo Comportamiento |
|-----------------|--------|---------------------|
| `_convenio_status` | **EXPANDIR** | Incluir 12 nuevos estados |
| `_convenio_terms` | **MANTENER + VERSIONAR** | Guardar hist√≥rico de cambios |
| `_convenio_start_date` | **HACER OBLIGATORIO** | Validaci√≥n al aprobar |
| `_convenio_end_date` | **HACER OBLIGATORIO** | C√°lculo autom√°tico de `near_expiry` |
| `_convenio_response_token` | **EXPANDIR** | Tokens por versi√≥n de negociaci√≥n |

### 6.3 Taxonom√≠as Recomendadas

```php
// Nueva taxonom√≠a para categorizar convenios
register_taxonomy('wpcw_convenio_type', 'wpcw_convenio', [
    'hierarchical' => true,
    'labels' => [
        'name' => 'Tipos de Convenio',
        'singular_name' => 'Tipo de Convenio'
    ],
    'show_in_rest' => true,
    'terms' => [
        'Descuento Porcentual',
        'Descuento Fijo',
        '2x1 o Promociones',
        'Beneficio Exclusivo',
        'Cashback',
        'Puntos'
    ]
]);

// Categor√≠as de comercio para matching
register_taxonomy('wpcw_business_category', 'wpcw_business', [
    'hierarchical' => true,
    'terms' => [
        'Gastronom√≠a',
        'Salud y Bienestar',
        'Educaci√≥n',
        'Entretenimiento',
        'Retail',
        'Servicios Profesionales',
        'Tecnolog√≠a',
        'Viajes y Turismo'
    ]
]);
```

---

## 7. Estad√≠sticas e Indicadores Clave (KPIs)

### 7.1 Dashboard para INSTITUCIONES

#### M√©tricas Principales (Hero Numbers)
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  CONVENIOS ACTIVOS          BENEFICIARIOS ACTIVOS   ‚îÇ
‚îÇ       12                           850              ‚îÇ
‚îÇ  ‚Üë 2 este mes                  ‚Üë 15% vs mes pasado ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ  CANJES ESTE MES            AHORRO GENERADO         ‚îÇ
‚îÇ       347                      $45,230 MXN          ‚îÇ
‚îÇ  ‚Üë 23% vs mes pasado          ‚Üë 18% vs mes pasado  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

#### Tabla de Convenios
```
| Comercio | Categor√≠a | Descuento | Canjes/Mes | Beneficiarios √önicos | Estado | Vence en |
|----------|-----------|-----------|------------|---------------------|--------|----------|
| Pizza Hut | Gastronom√≠a | 15% | 89 | 67 | üü¢ Activo | 45 d√≠as |
| Cin√©polis | Entretenimiento | 2x1 | 124 | 98 | üü† Por vencer | 12 d√≠as |
```

#### Gr√°ficas Esenciales
1. **Canjes por Mes** (L√≠nea de tiempo)
2. **Top 10 Comercios por Uso** (Barras horizontales)
3. **Distribuci√≥n por Categor√≠a** (Pie chart)
4. **Tasa de Adopci√≥n** (% de beneficiarios que usaron al menos 1 cup√≥n)

#### KPIs Institucionales Espec√≠ficos

| M√©trica | Descripci√≥n | F√≥rmula | Meta Benchmark |
|---------|-------------|---------|----------------|
| **Engagement Rate** | % de miembros activos | (Beneficiarios con ‚â•1 canje / Total miembros) √ó 100 | >40% |
| **Convenience Value** | Ahorro promedio por miembro | Total ahorro / Total miembros | >$500 MXN/a√±o |
| **Portfolio Diversity** | Variedad de categor√≠as usadas | # categor√≠as con canjes / # categor√≠as disponibles | >60% |
| **Member Satisfaction** | NPS de beneficiarios | Encuesta post-canje | >50 |
| **Proposal Success Rate** | % de propuestas enviadas que se activan | Convenios activos / Propuestas enviadas | >70% |

### 7.2 Dashboard para COMERCIOS

#### M√©tricas Principales
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  CONVENIOS ACTIVOS          CANJES ESTE MES         ‚îÇ
‚îÇ        3                          156               ‚îÇ
‚îÇ  ‚Üí                            ‚Üë 34% vs mes pasado   ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ  CLIENTES √öNICOS            VENTAS ATRIBUIBLES      ‚îÇ
‚îÇ       89                       $12,450 MXN          ‚îÇ
‚îÇ  ‚Üë 12 nuevos este mes         ‚Üë 28% vs mes pasado  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

#### Tabla de Convenios del Comercio
```
| Instituci√≥n | Miembros Potenciales | Canjes/Mes | Ticket Promedio | ROI Estimado | Estado |
|-------------|---------------------|------------|-----------------|-------------|--------|
| Sindicato Educadores | 850 | 89 | $140 | 4.2x | üü¢ Activo |
| Club Deportivo | 320 | 45 | $95 | 2.8x | üü¢ Activo |
| Asociaci√≥n M√©dicos | 450 | 22 | $210 | 5.1x | üü† Bajo uso |
```

#### KPIs para Comercios

| M√©trica | Descripci√≥n | F√≥rmula | Meta Benchmark |
|---------|-------------|---------|----------------|
| **Redemption Rate** | % de cupones canjeados | (Cupones canjeados / Cupones emitidos) √ó 100 | >30% |
| **Customer Acquisition Cost (CAC)** | Costo por nuevo cliente | Descuento total / Clientes √∫nicos nuevos | <$50 MXN |
| **Repeat Customer Rate** | % de clientes que regresan | (Clientes con ‚â•2 canjes / Total clientes) √ó 100 | >45% |
| **Average Ticket Lift** | Incremento en ticket vs clientes regulares | (Ticket con cup√≥n - Ticket sin cup√≥n) / Ticket sin cup√≥n | >15% |
| **Agreement Reach** | Cobertura de mercado | Miembros totales de instituciones activas | Variable |

### 7.3 Dashboard para ADMINISTRADORES

#### Visi√≥n General de la Plataforma
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  MARKETPLACE HEALTH                                              ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ  Instituciones Activas: 24         Comercios Activos: 156       ‚îÇ
‚îÇ  Convenios Activos: 342            Canjes Este Mes: 12,450      ‚îÇ
‚îÇ  Liquidity Rate: 78%               Match Success: 82%            ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

#### KPIs de Marketplace Bidireccional

| M√©trica | Descripci√≥n | F√≥rmula | Meta Benchmark |
|---------|-------------|---------|----------------|
| **Marketplace Liquidity** | % de propuestas que se activan | (Convenios activos / Total propuestas) √ó 100 | >75% |
| **Time to Activation** | D√≠as promedio desde propuesta hasta activo | AVG(fecha_active - fecha_proposed) | <7 d√≠as |
| **Counter-Offer Rate** | % de negociaciones con contra-oferta | (Convenios con ‚â•1 counter-offer / Total propuestas) √ó 100 | 15-25% (ideal) |
| **Supervisor Rejection Rate** | % rechazado en 2da aprobaci√≥n | (Rechazos supervisor / Total a supervisor) √ó 100 | <10% |
| **Platform Churn (Instituciones)** | % de instituciones que se vuelven inactivas | (Instituciones sin convenio activo 90d / Total) √ó 100 | <15% |
| **Platform Churn (Comercios)** | % de comercios que se vuelven inactivos | (Comercios sin convenio activo 90d / Total) √ó 100 | <20% |
| **Network Density** | Conexiones promedio por nodo | (Total convenios √ó 2) / (Instituciones + Comercios) | >2.5 |

#### Tabla de Convenios Globales con Filtros Avanzados
```
Filtros disponibles:
- Estado (todos los 12 estados)
- Fase (Negociaci√≥n / Aprobaci√≥n / Activo / Terminal)
- Categor√≠a de comercio
- Tama√±o de instituci√≥n
- Rendimiento (alto/medio/bajo uso)
- Pr√≥ximos a vencer (30/15/7 d√≠as)
```

### 7.4 Reportes Automatizados Recomendados

#### Frecuencia Semanal
- **Instituciones:** Top 5 convenios m√°s usados, nuevos comercios disponibles
- **Comercios:** Resumen de canjes, clientes nuevos, comparativa vs semana anterior

#### Frecuencia Mensual
- **Instituciones:** Reporte ejecutivo con ahorro total, engagement, recomendaciones
- **Comercios:** An√°lisis de ROI, sugerencias de optimizaci√≥n
- **Administradores:** Dashboard ejecutivo con KPIs de marketplace

#### Alertas en Tiempo Real
- Convenio pr√≥ximo a vencer (30, 15, 7 d√≠as antes)
- Convenio con bajo uso (< 5 canjes en 30 d√≠as)
- Propuesta sin respuesta (3, 5, 7 d√≠as)
- Comercio/Instituci√≥n inactivo (60 d√≠as sin actividad)

---

## 8. Mejoras de Experiencia de Usuario (UX)

### 8.1 Simplificaci√≥n del Proceso

#### Problema Actual
- Comercios deben salir de WordPress para revisar propuestas (email + link p√∫blico)
- Instituciones no tienen visibilidad de convenios activos en su dashboard
- Sin indicadores visuales de estado o progreso

#### Soluci√≥n: Dashboard Unificado con Estados Visuales

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  MIS CONVENIOS                                    [+ Nuevo] ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ  Tabs:  [ Activos (12) ]  [ Pendientes (3) ]  [ Todos ]   ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ                                                              ‚îÇ
‚îÇ  üü° ESPERANDO TU RESPUESTA                                  ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îÇ
‚îÇ  ‚îÇ Pizzer√≠a Don Antonio ‚Üí Tu Instituci√≥n                 ‚îÇ ‚îÇ
‚îÇ  ‚îÇ Propuesta: 15% descuento en consumo                   ‚îÇ ‚îÇ
‚îÇ  ‚îÇ Enviado: hace 2 d√≠as                                   ‚îÇ ‚îÇ
‚îÇ  ‚îÇ [Ver Detalles] [Aceptar] [Hacer Counter-Offer] [X]   ‚îÇ ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îÇ
‚îÇ                                                              ‚îÇ
‚îÇ  üü¢ ACTIVO                                                   ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îÇ
‚îÇ  ‚îÇ Cin√©polis                                    89 canjes ‚îÇ ‚îÇ
‚îÇ  ‚îÇ 2x1 en entradas                        Vence: 45 d√≠as ‚îÇ ‚îÇ
‚îÇ  ‚îÇ [Ver Stats] [Pausar] [Renovar]                        ‚îÇ ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îÇ
‚îÇ                                                              ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### 8.2 Wizard de Propuesta Paso a Paso

En lugar de un formulario largo, usar wizard multi-paso:

```
Paso 1: ¬øA qui√©n quieres proponer?
  [ ] Seleccionar instituci√≥n existente
  [ ] Invitar nueva instituci√≥n (email)

Paso 2: Define tu beneficio
  Tipo: (‚óè) Descuento porcentual  ( ) Descuento fijo  ( ) Promoci√≥n 2x1
  Valor: [___15___] %
  T√©rminos: [Aplicable a todo el men√∫, excepto bebidas alcoh√≥licas]

Paso 3: Restricciones (opcional)
  [ ] Limitar usos por persona: [_3_]
  [ ] V√°lido solo ciertos d√≠as: [‚úì] Lun-Vie
  [ ] Horarios espec√≠ficos: 09:00 - 18:00

Paso 4: Vigencia
  Desde: [01/11/2025]  Hasta: [31/12/2025]  (60 d√≠as)

[‚Üê Atr√°s]  [Enviar Propuesta ‚Üí]
```

### 8.3 Notificaciones: Cu√°ndo y C√≥mo

#### Canal de Notificaci√≥n por Evento

| Evento | Email | In-App | WhatsApp* | SMS* |
|--------|-------|--------|-----------|------|
| **Nueva propuesta recibida** | ‚úÖ Inmediato | ‚úÖ Badge | ‚ö™ Opcional | ‚ùå No |
| **Counter-offer recibida** | ‚úÖ Inmediato | ‚úÖ Badge | ‚ö™ Opcional | ‚ùå No |
| **Propuesta aceptada** | ‚úÖ Inmediato | ‚úÖ Notificaci√≥n | ‚ö™ Opcional | ‚ùå No |
| **Convenio activado** | ‚úÖ Inmediato | ‚úÖ Notificaci√≥n | ‚úÖ S√≠ | ‚ùå No |
| **Convenio pr√≥ximo a vencer (30d)** | ‚úÖ Weekly digest | ‚úÖ Badge | ‚ùå No | ‚ùå No |
| **Convenio pr√≥ximo a vencer (7d)** | ‚úÖ Inmediato | ‚úÖ Notificaci√≥n | ‚ö™ Opcional | ‚ö™ Opcional |
| **Propuesta sin respuesta (5d)** | ‚úÖ Reminder | ‚úÖ Badge | ‚ùå No | ‚ùå No |
| **Convenio con bajo uso** | ‚úÖ Monthly digest | ‚ö™ Opcional | ‚ùå No | ‚ùå No |

*WhatsApp y SMS: Requieren consentimiento expl√≠cito y configuraci√≥n adicional

#### Preferencias de Notificaci√≥n por Rol

```php
// Meta del usuario para preferencias
_wpcw_notification_preferences: [
    'email' => [
        'new_proposal' => true,
        'counter_offer' => true,
        'approval' => true,
        'expiry_warning' => true,
        'weekly_digest' => false
    ],
    'in_app' => [
        'all' => true
    ],
    'whatsapp' => [
        'high_priority_only' => true,
        'phone_number' => '+521234567890'
    ]
]
```

### 8.4 Dashboards Separados vs Unificado

**Recomendaci√≥n: UNIFICADO con vistas espec√≠ficas por rol**

#### Justificaci√≥n
- Pluxee y otros l√≠deres usan dashboard unificado
- Reduce curva de aprendizaje
- Consistencia en UX
- M√°s f√°cil de mantener

#### Implementaci√≥n
```
Panel Principal de Convenios
‚îú‚îÄ Vista: Business Owner
‚îÇ  ‚îú‚îÄ Mis Propuestas Enviadas
‚îÇ  ‚îú‚îÄ Propuestas Recibidas (de instituciones que me buscan)
‚îÇ  ‚îú‚îÄ Convenios Activos (con stats de canjes)
‚îÇ  ‚îî‚îÄ Acciones: [Proponer Nuevo Convenio]
‚îÇ
‚îú‚îÄ Vista: Institution Manager
‚îÇ  ‚îú‚îÄ Propuestas Recibidas (de comercios)
‚îÇ  ‚îú‚îÄ Mis Solicitudes Enviadas (a comercios)
‚îÇ  ‚îú‚îÄ Convenios Activos (con stats de uso por miembros)
‚îÇ  ‚îî‚îÄ Acciones: [Buscar Comercios] [Solicitar Convenio]
‚îÇ
‚îú‚îÄ Vista: Benefits Supervisor
‚îÇ  ‚îú‚îÄ Convenios Pendientes de Mi Aprobaci√≥n
‚îÇ  ‚îú‚îÄ Hist√≥rico de Aprobaciones
‚îÇ  ‚îî‚îÄ Sin opci√≥n de crear nuevos (solo aprobar)
‚îÇ
‚îî‚îÄ Vista: Administrator
   ‚îú‚îÄ TODOS los convenios (tabla completa)
   ‚îú‚îÄ Filtros avanzados
   ‚îú‚îÄ Auditor√≠a completa
   ‚îî‚îÄ Acciones: [Crear Pre-Aprobado] [Forzar Estado]
```

### 8.5 Onboarding para Usuarios No T√©cnicos

#### Primera Vez: Business Owner
```
1. Bienvenida con video corto (30 seg)
   "C√≥mo funcionan los convenios"

2. Tour guiado interactivo (4 pasos)
   ‚Üí "Aqu√≠ ver√°s propuestas recibidas"
   ‚Üí "Aqu√≠ puedes crear una propuesta"
   ‚Üí "Aqu√≠ est√°n tus convenios activos"
   ‚Üí "Aqu√≠ ves estad√≠sticas de canjes"

3. Sugerencia de primera acci√≥n
   "¬øQuieres proponer un convenio a una instituci√≥n?"
   [S√≠, empecemos] [M√°s tarde]

4. Templates pre-definidos
   "Usa una plantilla para acelerar:"
   - 15% descuento general
   - 2x1 en producto espec√≠fico
   - Descuento escalonado por volumen
```

#### Ayuda Contextual
- Tooltips en cada campo
- Link "¬øC√≥mo funciona esto?" en cada secci√≥n
- Chat de soporte (si disponible) o email directo

### 8.6 Mejoras Visuales Recomendadas

#### Estados con Colores y Iconos Consistentes
```
üü° Amarillo: Requiere acci√≥n (pending_review, counter_offered)
üîµ Azul: En proceso (under_negotiation, awaiting_approval)
üü¢ Verde: Activo y saludable (active)
üü† Naranja: Requiere atenci√≥n (paused, near_expiry)
üî¥ Rojo: Terminal negativo (rejected, expired, cancelled)
‚ö™ Gris: Borrador o inactivo (draft)
```

#### Progress Bar para Negociaci√≥n
```
Propuesta ‚Üí Revisi√≥n ‚Üí Negociaci√≥n ‚Üí Aprobaci√≥n ‚Üí Activo
    ‚óè‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚óè‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚óè‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚óã‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚óã
```

#### Badges Informativos
```
üÜï Nuevo (< 24h)
üî• Popular (alto uso)
‚è∞ Vence pronto (< 30 d√≠as)
‚ö†Ô∏è Bajo uso (< 10% de miembros)
‚ú® Recomendado
```

---

## 9. Plan de Implementaci√≥n

### 9.1 Enfoque de Implementaci√≥n: Iterativo e Incremental

**Filosof√≠a:** No romper el sistema actual, agregar capacidades gradualmente

### 9.2 Fase 1: Fundamentos (Sprint 1-2, 2 semanas)

#### Objetivos
- Expandir estados del convenio
- Implementar historial de negociaci√≥n
- Agregar metadatos b√°sicos

#### Tareas T√©cnicas
```
‚úì Actualizar enums de estado en convenio-meta-boxes.php
‚úì Crear funci√≥n helper para transiciones v√°lidas
‚úì Agregar campos meta para versionado
‚úì Migraci√≥n de datos: convenios existentes a nuevo formato
‚úì Testing de retrocompatibilidad
```

#### Entregables
- Estados expandidos funcionando
- Dashboard de administrador muestra nuevos estados
- Sin afectar convenios existentes

#### Riesgos
- **Bajo:** Solo afecta backend, sin cambios en flujo de usuario a√∫n

### 9.3 Fase 2: Propuestas Bidireccionales (Sprint 3-4, 2 semanas)

#### Objetivos
- Instituciones pueden proponer convenios
- Formulario unificado para ambas partes

#### Tareas T√©cnicas
```
‚úì Duplicar l√≥gica de business-convenios-page.php para instituciones
‚úì Crear institution-convenios-page.php
‚úì Modificar wpcw_handle_propose_convenio_form() para detectar rol
‚úì Actualizar email de notificaci√≥n con detecci√≥n de iniciador
‚úì Testing con ambos roles
```

#### Entregables
- Instituciones ven bot√≥n "Proponer Convenio"
- Comercios pueden recibir propuestas
- Emails adaptados al contexto

#### Riesgos
- **Medio:** Requiere permisos correctos y testing de roles

### 9.4 Fase 3: Counter-Offers y Negociaci√≥n (Sprint 5-7, 3 semanas)

#### Objetivos
- Implementar flujo de contra-ofertas
- Historial visible de cambios
- M√°ximo 2 rondas de negociaci√≥n

#### Tareas T√©cnicas
```
‚úì Crear UI de "Hacer Counter-Offer" en p√°gina de respuesta
‚úì Funci√≥n wpcw_create_counter_offer($convenio_id, $changes, $reason)
‚úì Comparador de versiones (diff visual)
‚úì L√≠mite de counter-offers (meta '_convenio_negotiation_rounds')
‚úì Estado under_negotiation y counter_offered
‚úì Testing de flujo completo: propuesta ‚Üí counter ‚Üí aceptar
```

#### Entregables
- Bot√≥n "Counter-Offer" en dashboard
- Modal/p√°gina con formulario de cambios
- Historial de negociaci√≥n visible
- L√≠mite de 2 rondas enforced

#### Riesgos
- **Alto:** Complejidad l√≥gica, requiere testing exhaustivo
- **Mitigaci√≥n:** Tests unitarios para transiciones de estado

### 9.5 Fase 4: Aprobaci√≥n Multi-Nivel (Sprint 8-9, 2 semanas)

#### Objetivos
- Instituciones grandes requieren aprobaci√≥n de supervisor
- Rol Benefits Supervisor funcional

#### Tareas T√©cnicas
```
‚úì Meta _convenio_requires_supervisor (boolean)
‚úì Estado pending_supervisor
‚úì Dashboard para Benefits Supervisor (ver solo pendientes)
‚úì L√≥gica de transici√≥n: awaiting_approval ‚Üí pending_supervisor (si required)
‚úì Notificaciones al supervisor
‚úì Testing con instituci√≥n que requiere 2 niveles
```

#### Entregables
- Checkbox "Requiere aprobaci√≥n de supervisor" en settings de instituci√≥n
- Dashboard de supervisor con lista filtrada
- Flujo completo: propuesta ‚Üí aprobaci√≥n manager ‚Üí aprobaci√≥n supervisor ‚Üí activo

#### Riesgos
- **Bajo:** Extensi√≥n natural del sistema de roles existente

### 9.6 Fase 5: KPIs y Dashboards (Sprint 10-12, 3 semanas)

#### Objetivos
- Implementar c√°lculo de m√©tricas
- Dashboards visuales para cada rol
- Reportes automatizados

#### Tareas T√©cnicas
```
‚úì Crear tabla de agregaci√≥n: wp_wpcw_convenio_stats
‚úì Cron job diario para calcular m√©tricas
‚úì Funciones helper: wpcw_get_institution_stats(), wpcw_get_business_stats()
‚úì Widgets de dashboard con Chart.js o similar
‚úì P√°gina institution-stats-page.php (expandir existente)
‚úì P√°gina business-stats-page.php (nueva)
‚úì Email reports weekly/monthly con PHPMailer templates
```

#### Entregables
- 3 dashboards funcionales (instituci√≥n, comercio, admin)
- Gr√°ficas de canjes por mes
- Email semanal con resumen
- P√°gina de stats con filtros

#### Riesgos
- **Medio:** Performance si hay muchos convenios
- **Mitigaci√≥n:** Usar tabla de agregaci√≥n pre-calculada

### 9.7 Fase 6: UX Refinement (Sprint 13-14, 2 semanas)

#### Objetivos
- Wizard de propuesta
- Notificaciones in-app
- Onboarding interactivo

#### Tareas T√©cnicas
```
‚úì Implementar multi-step form con JS (wizard)
‚úì Sistema de notificaciones in-app (bell icon con badge)
‚úì Tabla wp_wpcw_notifications
‚úì Tour guiado con biblioteca (Intro.js o similar)
‚úì Templates de email mejorados (HTML responsive)
‚úì Preferencias de notificaci√≥n por usuario
```

#### Entregables
- Wizard de 4 pasos para crear propuesta
- Campana de notificaciones funcional
- Tour interactivo al primer login
- Emails visualmente mejorados

#### Riesgos
- **Bajo:** Principalmente frontend, no afecta l√≥gica de negocio

### 9.8 Cronograma Total

```
Semanas 1-2:   Fase 1 (Fundamentos)
Semanas 3-4:   Fase 2 (Bidireccional)
Semanas 5-7:   Fase 3 (Counter-Offers)
Semanas 8-9:   Fase 4 (Multi-Nivel)
Semanas 10-12: Fase 5 (KPIs)
Semanas 13-14: Fase 6 (UX)

Total: 14 semanas (~3.5 meses)
```

### 9.9 Criterios de Aceptaci√≥n (Gherkin)

#### Ejemplo: Counter-Offer
```gherkin
Feature: Counter-Offer en Negociaci√≥n de Convenio

  Scenario: Instituci√≥n hace contra-oferta a propuesta de comercio
    Given un comercio propone convenio con 15% descuento
    And la instituci√≥n recibe la notificaci√≥n
    When la instituci√≥n accede a revisar la propuesta
    And hace clic en "Hacer Counter-Offer"
    And cambia descuento a 20%
    And agrega justificaci√≥n "Nuestros miembros esperan m√°s beneficios"
    And env√≠a la contra-oferta
    Then el estado cambia a "counter_offered"
    And el comercio recibe notificaci√≥n de counter-offer
    And puede ver el diff: 15% ‚Üí 20%
    And puede aceptar o rechazar

  Scenario: L√≠mite de 2 rondas de negociaci√≥n
    Given un convenio con 2 counter-offers ya realizadas
    When cualquier parte intenta hacer otra contra-oferta
    Then el bot√≥n "Counter-Offer" est√° deshabilitado
    And muestra mensaje "M√°ximo de rondas alcanzado. Acepta, rechaza o contacta directamente."
```

---

## 10. Referencias de la Industria

### Fuentes Consultadas

#### Marketplaces B2B y Beneficios Corporativos
1. **Pluxee (Sodexo Benefits & Rewards)**
   - Sitio oficial: https://www.pluxeegroup.com/
   - Inversi√≥n tecnol√≥gica: 10% de ingresos anuales en tech (2025)
   - 250+ productos en 31 pa√≠ses
   - Modelo: Marketplace de beneficios m√≥vil-first

2. **Gartner: B2B Digital Commerce Trends 2025**
   - 80% de interacciones B2B ser√°n digitales para 2025
   - √ânfasis en self-service y automatizaci√≥n

3. **TradeCentric: What is a B2B Marketplace?**
   - Definici√≥n: Plataforma donde compradores y proveedores hacen transacciones
   - Caracter√≠sticas clave: Precios basados en cuenta, workflows de aprobaci√≥n, multi-usuario

#### KPIs de Marketplaces de Dos Lados
4. **Reforge: The 8 Most Important Metrics for Marketplace Growth**
   - Liquidity como m√©trica #1
   - LTV/CAC ratio: meta >3X
   - Take rate y contribution margins

5. **Andreessen Horowitz (a16z): 13 Metrics for Marketplace Companies**
   - GMV (Gross Merchandise Value)
   - Net revenue
   - Buyer/Seller funnel metrics

6. **Sharetribe: Marketplace Metrics - 26 Key Metrics**
   - Supply/Demand balance
   - Repeat purchase rate
   - Time to first transaction

#### Negociaci√≥n de Contratos y Propuestas
7. **Harvard Program on Negotiation (PON)**
   - "How to Counter Offer Successfully"
   - "Negotiation Techniques for Business Partnerships"
   - Fases de negociaci√≥n: Opening ‚Üí Testing ‚Üí Agreeing
   - Counter-offers: usar al final, no al inicio

8. **World Bank: Negotiations and Best and Final Offer (BAFO)**
   - Framework para negociaciones en procurement
   - Rondas limitadas de contra-ofertas
   - Documentaci√≥n de cada fase

#### Loyalty Program KPIs
9. **Open Loyalty: Loyalty Program KPIs - Templates and Best Practices**
   - Customer retention rate
   - Net Promoter Score (NPS)
   - Customer Lifetime Value (CLV)

10. **Mageworx: 8 KPIs to Measure Effectiveness of Loyalty Programs**
    - Repeat purchase rate
    - Redemption rate
    - Program engagement rate

### Tecnolog√≠as y Herramientas Recomendadas

| Necesidad | Herramienta | Justificaci√≥n |
|-----------|-------------|---------------|
| **Gr√°ficas de KPIs** | Chart.js | Libre, ligera, integra bien con WordPress |
| **Tour interactivo** | Intro.js | Open source, f√°cil implementaci√≥n |
| **Email templates** | Foundation for Emails | Responsive, compatible con todos los clientes |
| **Notificaciones in-app** | WP Admin Notices API + Custom | Nativo de WordPress |
| **Diff de versiones** | jsdiff.js | Comparaci√≥n visual de cambios |
| **Logs de auditor√≠a** | WP_Error + tabla custom | Ya usado en el proyecto |

### Casos de Estudio Inspiradores

#### Caso 1: Pluxee Employee Experience Platform
- **Problema:** Administraci√≥n compleja de m√∫ltiples beneficios
- **Soluci√≥n:** Dashboard unificado "admin-light"
- **Resultado:** Reducci√≥n del 60% en tiempo de administraci√≥n para HR
- **Aplicable:** Nuestro dashboard unificado con vistas por rol

#### Caso 2: Amazon Business (B2B Marketplace)
- **Problema:** Aprobaciones corporativas ralentizan compras
- **Soluci√≥n:** Workflows de aprobaci√≥n configurables por empresa
- **Resultado:** 45% m√°s r√°pido time-to-purchase
- **Aplicable:** Nuestra aprobaci√≥n multi-nivel opcional

#### Caso 3: Airbnb for Business
- **Problema:** Propuestas de alojamiento no se convert√≠an
- **Soluci√≥n:** Sistema de instant booking + counter-offer opcional
- **Resultado:** 80% de bookings sin negociaci√≥n, 15% con 1 contra-oferta
- **Aplicable:** Nuestro l√≠mite de 2 rondas de negociaci√≥n

---

## Conclusi√≥n

### Resumen de Recomendaciones Prioritarias

| Prioridad | Recomendaci√≥n | Impacto Esperado | Esfuerzo |
|-----------|--------------|------------------|----------|
| üî¥ CR√çTICA | Propuestas bidireccionales | +40% engagement instituciones | 2 semanas |
| üî¥ CR√çTICA | Estados expandidos (12 estados) | +60% claridad en workflow | 2 semanas |
| üî¥ CR√çTICA | KPIs b√°sicos (dashboards) | +80% visibilidad de valor | 3 semanas |
| üü° ALTA | Counter-offers (max 2 rondas) | +25% success rate de propuestas | 3 semanas |
| üü° ALTA | Notificaciones in-app | -50% tiempo de respuesta | 2 semanas |
| üü¢ MEDIA | Aprobaci√≥n multi-nivel | +15% instituciones grandes | 2 semanas |
| üü¢ MEDIA | Wizard de propuesta | -30% errores en creaci√≥n | 2 semanas |
| üîµ BAJA | Borradores compartidos | +10% colaboraci√≥n pre-aprobaci√≥n | 1 semana |

### Pr√≥ximos Pasos Inmediatos

1. **Validar con stakeholders:** Compartir este documento con el equipo y usuarios piloto
2. **Priorizar fases:** Confirmar si cronograma de 14 semanas es viable
3. **Definir m√©tricas de √©xito:** Establecer baseline antes de implementar cambios
4. **Preparar ambiente de pruebas:** Clonar datos de producci√≥n para testing
5. **Iniciar Fase 1:** Expandir estados y agregar metadatos base

### M√©tricas de √âxito del Proyecto

Al finalizar la implementaci√≥n completa, esperamos:
- **Engagement de instituciones:** De 25% a 65% de miembros activos
- **Time to activation:** De 14 d√≠as a 5 d√≠as promedio
- **Marketplace liquidity:** De 45% a 75% de propuestas activadas
- **Satisfacci√≥n de usuarios:** NPS de 50+ (a medir post-implementaci√≥n)
- **Retention:** <15% churn anual en ambos lados del marketplace

---

**Documento elaborado por:** Sistema de An√°lisis WP Cupon WhatsApp
**Fecha:** Octubre 2025
**Versi√≥n:** 1.0
**Estado:** Propuesta para revisi√≥n

**Contacto para discusi√≥n:** Equipo de desarrollo WP Cupon WhatsApp
**Pr√≥xima revisi√≥n:** Tras validaci√≥n con stakeholders
